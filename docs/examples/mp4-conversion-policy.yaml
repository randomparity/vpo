# MP4 Conversion Policy for Video Policy Orchestrator
# This policy converts MKV files to MP4 for device compatibility.
#
# Usage: vpo policy run --policy mp4-conversion-policy.yaml [--dry-run] <file.mkv>
#
# Note: MP4 has codec limitations. This policy will skip files with:
# - TrueHD or DTS-HD MA audio
# - PGS or VobSub subtitles
# - Embedded fonts/attachments

schema_version: 3

# Track type ordering
track_order:
  - video
  - audio_main
  - audio_alternate
  - subtitle_main
  - subtitle_forced
  - audio_commentary
  - subtitle_commentary
  - attachment

# Language preferences
audio_language_preference:
  - eng
  - und

subtitle_language_preference:
  - eng

# Default flag behavior
default_flags:
  set_first_video_default: true
  set_preferred_audio_default: true
  set_preferred_subtitle_default: false
  clear_other_defaults: true

# V3: Container conversion to MP4
container:
  target: mp4
  # Skip files with incompatible codecs instead of failing
  on_incompatible_codec: skip

# V3: Remove attachments (not supported in MP4)
attachment_filter:
  remove_all: true
