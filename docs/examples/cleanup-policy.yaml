# Cleanup Policy for Video Policy Orchestrator
# This policy removes unwanted tracks and attachments for smaller files.
#
# Usage: vpo process --policy cleanup-policy.yaml [--dry-run] <file.mkv>
#
# Use case: Reduce file size by removing:
# - Non-English audio tracks
# - All subtitle tracks
# - Font attachments and cover art

schema_version: 13

config:
  audio_languages: [eng, und]
  subtitle_languages: [eng]
  on_error: continue

phases:
  - name: cleanup
    # Track type ordering
    track_order:
      - video
      - audio_main
      - audio_alternate
      - attachment

    # Default flag behavior
    default_flags:
      set_first_video_default: true
      set_preferred_audio_default: true
      set_preferred_subtitle_default: false
      clear_other_defaults: true

    # Keep only English audio
    keep_audio:
      languages:
        - eng
        - und
      minimum: 1
      fallback:
        # Keep first track if no English found (safety measure)
        mode: keep_first

    # Remove ALL subtitles
    keep_subtitles:
      remove_all: true

    # Remove ALL attachments (fonts, cover art)
    filter_attachments:
      remove_all: true
