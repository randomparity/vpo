# Container Conversion Policy for Video Policy Orchestrator
# This policy converts files to MKV format with track ordering.
#
# Usage: vpo process --policy container-conversion-policy.yaml [--dry-run] <file.avi>

schema_version: 13

config:
  audio_languages: [eng, und]
  subtitle_languages: [eng, und]
  on_error: continue

phases:
  - name: convert
    # Container conversion
    # Converts AVI, MOV, MP4, and other formats to MKV
    container:
      target: mkv
      # MKV supports all codecs, so this is rarely needed
      on_incompatible_codec: error

  - name: organize
    # Track type ordering
    track_order:
      - video
      - audio_main
      - audio_alternate
      - subtitle_main
      - subtitle_forced
      - audio_commentary
      - subtitle_commentary
      - attachment

    # Default flag behavior
    default_flags:
      set_first_video_default: true
      set_preferred_audio_default: true
      set_preferred_subtitle_default: false
      clear_other_defaults: true
